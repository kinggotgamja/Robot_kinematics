% Jacobian
function KUKA_jaco = KUKA_jacobian(th1,th2,th3,th4,th5,th6,th7)
global a1 a2 a3 a4 a5 a6 a7 a8 a9 a10;
global d1 d2 d3 d4 d5 d6 d7 d8 d9 d10;

KUKA_jaco = [...
d7*(cos(th6)*(sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) - cos(th4)*sin(th1)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) + sin(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th1)*cos(th3) - cos(th2)*sin(th1)*sin(th3)))) + d5*(sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) - cos(th4)*sin(th1)*sin(th2)) - d3*sin(th1)*sin(th2),                               cos(th1)*(d5*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4)) + d7*(sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4))) + d3*cos(th2)), d5*cos(th3)*sin(th1)*sin(th4) + d5*cos(th1)*cos(th2)*sin(th3)*sin(th4) + d7*cos(th3)*cos(th6)*sin(th1)*sin(th4) + d7*sin(th1)*sin(th3)*sin(th5)*sin(th6) + d7*cos(th1)*cos(th2)*cos(th6)*sin(th3)*sin(th4) - d7*cos(th1)*cos(th2)*cos(th3)*sin(th5)*sin(th6) - d7*cos(th3)*cos(th4)*cos(th5)*sin(th1)*sin(th6) - d7*cos(th1)*cos(th2)*cos(th4)*cos(th5)*sin(th3)*sin(th6), - (cos(th1)*cos(th3) - cos(th2)*sin(th1)*sin(th3))*(d5*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4)) + d7*(sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4)))) - sin(th2)*sin(th3)*(d7*(cos(th6)*(sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) - cos(th4)*sin(th1)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) + sin(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th1)*cos(th3) - cos(th2)*sin(th1)*sin(th3)))) + d5*(sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) - cos(th4)*sin(th1)*sin(th2))), d7*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4))*(cos(th6)*(sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) - cos(th4)*sin(th1)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) + sin(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th1)*cos(th3) - cos(th2)*sin(th1)*sin(th3)))) - d7*(sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) - cos(th4)*sin(th1)*sin(th2))*(sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4))), - d7*(sin(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) - cos(th5)*sin(th2)*sin(th3))*(cos(th6)*(sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) - cos(th4)*sin(th1)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) + sin(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th1)*cos(th3) - cos(th2)*sin(th1)*sin(th3)))) - d7*(sin(th5)*(cos(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) + sin(th1)*sin(th2)*sin(th4)) - cos(th5)*(cos(th1)*cos(th3) - cos(th2)*sin(th1)*sin(th3)))*(sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4))),                                                                                                                                                                                                                                                                            0;
d7*(cos(th6)*(sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) - cos(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3)))) + d5*(sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2)) + d3*cos(th1)*sin(th2),                               sin(th1)*(d5*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4)) + d7*(sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4))) + d3*cos(th2)), d5*cos(th2)*sin(th1)*sin(th3)*sin(th4) - d7*cos(th1)*cos(th3)*cos(th6)*sin(th4) - d5*cos(th1)*cos(th3)*sin(th4) - d7*cos(th1)*sin(th3)*sin(th5)*sin(th6) + d7*cos(th1)*cos(th3)*cos(th4)*cos(th5)*sin(th6) + d7*cos(th2)*cos(th6)*sin(th1)*sin(th3)*sin(th4) - d7*cos(th2)*cos(th3)*sin(th1)*sin(th5)*sin(th6) - d7*cos(th2)*cos(th4)*cos(th5)*sin(th1)*sin(th3)*sin(th6), - (cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3))*(d5*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4)) + d7*(sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4)))) - sin(th2)*sin(th3)*(d7*(cos(th6)*(sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) - cos(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3)))) + d5*(sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2))), d7*(cos(th6)*(sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) - cos(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3))))*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4)) - d7*(sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2))*(sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4))), - d7*(sin(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) - cos(th5)*sin(th2)*sin(th3))*(cos(th6)*(sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) - cos(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3)))) - d7*(sin(th5)*(cos(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) - cos(th1)*sin(th2)*sin(th4)) - cos(th5)*(cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3)))*(sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4))),                                                                                                                                                                                                                                                                            0;
                                                                                                                                                                                                                                                                                                                                                                                                     0, d5*cos(th2)*cos(th3)*sin(th4) - d5*cos(th4)*sin(th2) - d3*sin(th2) - d7*cos(th4)*cos(th6)*sin(th2) + d7*cos(th2)*cos(th3)*cos(th6)*sin(th4) + d7*cos(th2)*sin(th3)*sin(th5)*sin(th6) - d7*cos(th5)*sin(th2)*sin(th4)*sin(th6) - d7*cos(th2)*cos(th3)*cos(th4)*cos(th5)*sin(th6),                                                                                                                                                                                                                                 -sin(th2)*(d5*sin(th3)*sin(th4) + d7*cos(th6)*sin(th3)*sin(th4) - d7*cos(th3)*sin(th5)*sin(th6) - d7*cos(th4)*cos(th5)*sin(th3)*sin(th6)),                                                                                                                                                                                                                                                                                                                                                                                                                                                            d5*cos(th3)*cos(th4)*sin(th2) - d5*cos(th2)*sin(th4) - d7*cos(th2)*cos(th6)*sin(th4) + d7*cos(th3)*cos(th4)*cos(th6)*sin(th2) + d7*cos(th2)*cos(th4)*cos(th5)*sin(th6) + d7*cos(th3)*cos(th5)*sin(th2)*sin(th4)*sin(th6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      d7*sin(th6)*(cos(th5)*sin(th2)*sin(th3) - cos(th2)*sin(th4)*sin(th5) + cos(th3)*cos(th4)*sin(th2)*sin(th5)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 -d7*(cos(th2)*cos(th4)*sin(th6) - cos(th2)*cos(th5)*cos(th6)*sin(th4) + cos(th3)*sin(th2)*sin(th4)*sin(th6) - cos(th6)*sin(th2)*sin(th3)*sin(th5) + cos(th3)*cos(th4)*cos(th5)*cos(th6)*sin(th2)),                                                                                                                                                                                                                                                                            0;
                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                       -sin(th1),                                                                                                                                                                                                                                                                                                                                                         cos(th1)*sin(th2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     sin(th5)*(cos(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) - cos(th1)*sin(th2)*sin(th4)) - cos(th5)*(cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3)), cos(th6)*(sin(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) + cos(th1)*cos(th4)*sin(th2)) - sin(th6)*(cos(th5)*(cos(th4)*(sin(th1)*sin(th3) - cos(th1)*cos(th2)*cos(th3)) - cos(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th3)*sin(th1) + cos(th1)*cos(th2)*sin(th3)));
                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                        cos(th1),                                                                                                                                                                                                                                                                                                                                                         sin(th1)*sin(th2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      cos(th2)*sin(th1)*sin(th3) - cos(th1)*cos(th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           cos(th4)*sin(th1)*sin(th2) - sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cos(th5)*(cos(th1)*cos(th3) - cos(th2)*sin(th1)*sin(th3)) - sin(th5)*(cos(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) + sin(th1)*sin(th2)*sin(th4)), sin(th6)*(cos(th5)*(cos(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) + sin(th1)*sin(th2)*sin(th4)) + sin(th5)*(cos(th1)*cos(th3) - cos(th2)*sin(th1)*sin(th3))) - cos(th6)*(sin(th4)*(cos(th1)*sin(th3) + cos(th2)*cos(th3)*sin(th1)) - cos(th4)*sin(th1)*sin(th2));
                                                                                                                                                                                                                                                                                                                                                                                                     1,                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                  cos(th2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -sin(th2)*sin(th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cos(th5)*sin(th2)*sin(th3) - sin(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)),                                                                                                                sin(th6)*(cos(th5)*(cos(th2)*sin(th4) - cos(th3)*cos(th4)*sin(th2)) + sin(th2)*sin(th3)*sin(th5)) + cos(th6)*(cos(th2)*cos(th4) + cos(th3)*sin(th2)*sin(th4))];
end
